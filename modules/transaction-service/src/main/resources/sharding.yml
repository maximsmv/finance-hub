dataSources:
  ds_0:
    dataSourceClassName: com.zaxxer.hikari.HikariDataSource
    driverClassName: org.postgresql.Driver
    jdbcUrl: jdbc:postgresql://transaction-service-postgres-0:5432/transaction_db_0
    username: transaction-service
    password: password
  ds_1:
    dataSourceClassName: com.zaxxer.hikari.HikariDataSource
    driverClassName: org.postgresql.Driver
    jdbcUrl: jdbc:postgresql://transaction-service-postgres-1:5432/transaction_db_1
    username: transaction-service
    password: password
rules:
  - !SINGLE
    tables:
      - ds_0.wallet_types
      - ds_1.wallet_types

  - !SHARDING
    tables:
      transactions:
        actualDataNodes: ds_${0..1}.transactions
      wallets:
        actualDataNodes: ds_${0..1}.wallets
    defaultDatabaseStrategy:
      standard:
        shardingColumn: user_uid
        shardingAlgorithmName: database_inline
    shardingAlgorithms:
      database_inline:
        type: INLINE
        props:
          algorithm-expression: ds_${(user_uid.hashCode() % 2 + 2) % 2}